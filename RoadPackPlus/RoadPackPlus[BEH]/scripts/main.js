import{world as b}from"@minecraft/server";var f={onUseOn(t){t.source,t.usedOnBlockPermutation}},_={beforeOnPlayerPlace(t){let{player:e}=t;if(!e)return;let r=e.getRotation().y,c=y(r),n=t.block.location;switch(t.cancel=!0,c){case 0:case 4:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_thin_a_full`);break;case 1:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_slanting_b_full`);break;case 2:case 6:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_thin_b_full`);break;case 3:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_slanting_d_full`);break;case 5:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_slanting_a_full`);break;case 7:e.runCommand(`/setblock ${n.x} ${n.y} ${n.z} hakomc:gray_line_slanting_c_full`);break}}};function y(t){t<0&&(t+=360);let e=Math.round(t/45);return e!==8?e:0}b.beforeEvents.worldInitialize.subscribe(({itemComponentRegistry:t,blockComponentRegistry:e})=>{t.registerCustomComponent("hakomc:onuseon",f),e.registerCustomComponent("hakomc:line_rotation",_)});b.afterEvents.playerInteractWithBlock.subscribe(t=>{let e=t.player,r=t.beforeItemStack.typeId,c=r.split("_"),a=t.block.typeId.split("_"),i=t.block.location;if(!r.startsWith("hakomc:block_change_"))return;let s;switch(e.isSneaking?s="-":s="+",c[2]){case"num":let u=parseInt(c[3]);if(isNaN(u))return;if(a[1]==="cp"){let o=a[2]==="full"?16:parseInt(a[2]);if(isNaN(o))return;let l=m(o,u,s);k(a,i,e,l,2),e.onScreenDisplay.setActionBar(`${l}`)}else if(a[0]==="hakomc:gray"&&a[1]==="line"){let o=a[4]==="full"?16:parseInt(a[4]);if(isNaN(o))return;let l=m(o,u,s);k(a,i,e,l,4),e.onScreenDisplay.setActionBar(`${l}`)}break;case"rotate":if(a[0]==="hakomc:gray"&&a[2]==="slanting"){let o=a[3];switch(o){case"a":o=s==="+"?"c":"d";break;case"b":o=s==="+"?"d":"c";break;case"c":o=s==="+"?"b":"a";break;case"d":o=s==="+"?"a":"b";break}k(a,i,e,o,3)}else if(a[0]==="hakomc:gray"&&(a[2]==="thin"||a[2]==="thick")){let o=a[3];switch(o){case"a":o="b";break;case"b":o="a";break}k(a,i,e,o,3)}break;default:break}});function k(t,e,r,c,n){t[n]=c===16?"full":c.toString();let a=t.join("_");r.runCommand(`/setblock ${e.x} ${e.y} ${e.z} ${a}`)}function m(t,e,r){let c=r==="+"?t+e:t-e;return c===0?16:r==="+"?c>=17?c-16:c:c<0?c+16:c}
